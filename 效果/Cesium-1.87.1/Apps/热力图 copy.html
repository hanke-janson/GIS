<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <title>热力图</title>
    <script src="../Build/Cesium/Cesium.js"></script>
    <script src="./CesiumHeatmap.js"></script>
    <style>
        @import url(../Build/Cesium/Widgets/widgets.css);

        html,
        body,
        #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000000;
        }
    </style>

</head>

<body>
    <div id="cesiumContainer">
    </div>
    <script>
        // Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3ODJlOTEzOC1mNDk2LTQ5ZmQtOGRiZS01MGM4NTJlODQ4OWIiLCJpZCI6MTAzMTc4LCJpYXQiOjE2NjE0OTg2OTl9.cz6BzXKJGSAgkCFfyZ9SAD_7otWUgjf6MhrySxL7bQc"
        var viewer = new Cesium.Viewer('cesiumContainer', {
            geocoder: false,   // 位置查找工具
            baseLayerPicker: false,// 图层选择器（地形影像服务）
            timeline: false, // 底部时间线
            homeButton: false,// 视角返回初始位置
            fullscreenButton: false, // 全屏
            animation: false,   // 左下角仪表盘（动画器件）
            sceneModePicker: false,// 选择视角的模式（球体、平铺、斜视平铺）
            navigationHelpButton: false, //导航帮助按钮
            infoBox: false,
            // 加载本地离线地图
            imageryProvider: new Cesium.UrlTemplateImageryProvider({
                // 本地
                url: "http://localhost:8889/bm/map/{z}/{x}/{y}",
                maximumLevel: 14,
            }),
        });


        //苏州热力数据
        let szPoint = [
            {
                "x": 120.668435,
                "y": 31.374082,
                "value": 100
            },
            {
                "x": 120.686138,
                "y": 31.383773,
                "value": 57
            },
            {
                "x": 120.688073,
                "y": 31.388262,
                "value": 58
            },
            {
                "x": 120.697757,
                "y": 31.392517,
                "value": 60
            },
            {
                "x": 120.700801,
                "y": 31.393463,
                "value": 53
            },
            {
                "x": 120.705782,
                "y": 31.396772,
                "value": 7
            },
            {
                "x": 120.710763,
                "y": 31.398663,
                "value": 37
            },
            {
                "x": 120.714361,
                "y": 31.392283,
                "value": 13
            },
            {
                "x": 120.707998,
                "y": 31.378816,
                "value": 19
            },
            {
                "x": 120.706128,
                "y": 31.377039,
                "value": 83
            },
            {
                "x": 120.706959,
                "y": 31.373496,
                "value": 30
            },
            {
                "x": 120.706889,
                "y": 31.371754,
                "value": 88
            },
            {
                "x": 120.711039,
                "y": 31.364196,
                "value": 36
            },
            {
                "x": 120.714082,
                "y": 31.36396,
                "value": 26
            },
            {
                "x": 120.717402,
                "y": 31.362543,
                "value": 9
            },
            {
                "x": 120.722658,
                "y": 31.359944,
                "value": 83
            },
            {
                "x": 120.732062,
                "y": 31.354984,
                "value": 69
            },
            {
                "x": 120.738148,
                "y": 31.352385,
                "value": 46
            },
            {
                "x": 120.741742,
                "y": 31.346243,
                "value": 49
            },
            {
                "x": 120.743677,
                "y": 31.337739,
                "value": 11
            },
            {
                "x": 120.75446,
                "y": 31.316947,
                "value": 9
            },
            {
                "x": 120.754183,
                "y": 31.316239,
                "value": 61
            },
            {
                "x": 120.75916,
                "y": 31.306721,
                "value": 2
            },
            {
                "x": 120.759989,
                "y": 31.297031,
                "value": 72
            },
            {
                "x": 120.75031,
                "y": 31.2968,
                "value": 98
            },
            {
                "x": 120.729571,
                "y": 31.297987,
                "value": 48
            },
            {
                "x": 120.714641,
                "y": 31.303423,
                "value": 10
            },
            {
                "x": 120.713257,
                "y": 31.309094,
                "value": 18
            },
            {
                "x": 120.726805,
                "y": 31.314291,
                "value": 15
            },
            {
                "x": 120.714915,
                "y": 31.319253,
                "value": 9
            },
            {
                "x": 120.702482,
                "y": 31.327047,
                "value": 80
            },
            {
                "x": 120.701097,
                "y": 31.338858,
                "value": 77
            },
            {
                "x": 120.707635,
                "y": 31.34932,
                "value": 65
            },
            {
                "x": 120.713997,
                "y": 31.335148,
                "value": 72
            },
            {
                "x": 120.713445,
                "y": 31.326645,
                "value": 17
            },
            {
                "x": 120.700175,
                "y": 31.314833,
                "value": 95
            },
            {
                "x": 120.688565,
                "y": 31.308925,
                "value": 56
            },
            {
                "x": 120.681381,
                "y": 31.298291,
                "value": 70
            },
            {
                "x": 120.682487,
                "y": 31.297347,
                "value": 96
            },
            {
                "x": 120.712897,
                "y": 31.290264,
                "value": 5
            },
            {
                "x": 120.718426,
                "y": 31.2905,
                "value": 91
            },
            {
                "x": 120.729761,
                "y": 31.296642,
                "value": 38
            },
            {
                "x": 120.743585,
                "y": 31.297348,
                "value": 19
            },
            {
                "x": 120.744692,
                "y": 31.300183,
                "value": 32
            },
            {
                "x": 120.745521,
                "y": 31.301836,
                "value": 79
            },
            {
                "x": 120.748299,
                "y": 31.306119,
                "value": 64
            },
            {
                "x": 120.748853,
                "y": 31.308481,
                "value": 56
            },
            {
                "x": 120.74913,
                "y": 31.31297,
                "value": 30
            },
            {
                "x": 120.74111,
                "y": 31.315335,
                "value": 79
            },
            {
                "x": 120.72839,
                "y": 31.317463,
                "value": 26
            },
            {
                "x": 120.726454,
                "y": 31.319353,
                "value": 99
            },
            {
                "x": 120.714287,
                "y": 31.325494,
                "value": 32
            },
            {
                "x": 120.71401,
                "y": 31.325731,
                "value": 92
            },
            {
                "x": 120.738015,
                "y": 31.32767,
                "value": 82
            },
            {
                "x": 120.744185,
                "y": 31.317248,
                "value": 3
            },
            {
                "x": 120.725062,
                "y": 31.307079,
                "value": 65
            },
            {
                "x": 120.710421,
                "y": 31.308218,
                "value": 68
            },
            {
                "x": 120.710104,
                "y": 31.299549,
                "value": 59
            },
            {
                "x": 120.717484,
                "y": 31.29713,
                "value": 32
            },
            {
                "x": 120.722824,
                "y": 31.296944,
                "value": 73
            },
            {
                "x": 120.723274,
                "y": 31.290495,
                "value": 58
            },
            {
                "x": 120.727456,
                "y": 31.287032,
                "value": 28
            },
            {
                "x": 120.69478,
                "y": 31.283772,
                "value": 60
            },
            {
                "x": 120.676413,
                "y": 31.283046,
                "value": 77
            },
            {
                "x": 120.675549,
                "y": 31.282865,
                "value": 31
            },
            {
                "x": 120.680282,
                "y": 31.276796,
                "value": 4
            },
            {
                "x": 120.698247,
                "y": 31.273269,
                "value": 34
            },
            {
                "x": 120.723374,
                "y": 31.272218,
                "value": 100
            },
            {
                "x": 120.736585,
                "y": 31.275035,
                "value": 100
            },
            {
                "x": 120.745777,
                "y": 31.279471,
                "value": 100
            },
            {
                "x": 120.751088,
                "y": 31.282693,
                "value": 100
            },
            {
                "x": 120.757373,
                "y": 31.287752,
                "value": 100
            },
            {
                "x": 120.758732,
                "y": 31.30273,
                "value": 100
            },
            {
                "x": 120.758945,
                "y": 31.316499,
                "value": 100
            },
            {
                "x": 120.761492,
                "y": 31.344917,
                "value": 3
            },
            {
                "x": 120.76694,
                "y": 31.382806,
                "value": 83
            },
            {
                "x": 120.76589,
                "y": 31.387562,
                "value": 35
            },
            {
                "x": 120.758214,
                "y": 31.394899,
                "value": 91
            },
            {
                "x": 120.730968,
                "y": 31.403159,
                "value": 100
            },
            {
                "x": 120.711442,
                "y": 31.404812,
                "value": 100
            },
            {
                "x": 120.690595,
                "y": 31.401832,
                "value": 100
            },
            {
                "x": 120.679832,
                "y": 31.393932,
                "value": 100
            },
            {
                "x": 120.670814,
                "y": 31.381412,
                "value": 100
            },
            {
                "x": 120.672233,
                "y": 31.368546,
                "value": 100
            },
            {
                "x": 120.673351,
                "y": 31.353035,
                "value": 100
            },
            {
                "x": 120.684359,
                "y": 31.372061,
                "value": 100
            },
            {
                "x": 120.695252,
                "y": 31.368108,
                "value": 100
            },
            {
                "x": 120.690044,
                "y": 31.355587,
                "value": 100
            },
            {
                "x": 120.689004,
                "y": 31.347558,
                "value": 100
            },
            {
                "x": 120.689228,
                "y": 31.34297,
                "value": 100
            },
            {
                "x": 120.690055,
                "y": 31.335568,
                "value": 100
            },
            {
                "x": 120.691422,
                "y": 31.335963,
                "value": 100
            },
            {
                "x": 120.697691,
                "y": 31.342086,
                "value": 100
            },
            {
                "x": 120.704069,
                "y": 31.347567,
                "value": 100
            },
            {
                "x": 120.705733,
                "y": 31.346608,
                "value": 100
            },
            {
                "x": 120.706342,
                "y": 31.342177,
                "value": 100
            },
            {
                "x": 120.703215,
                "y": 31.334653,
                "value": 100
            },
            {
                "x": 120.697903,
                "y": 31.338251,
                "value": 100
            },
            {
                "x": 120.697903,
                "y": 31.338251,
                "value": 83
            },
            {
                "x": 120.702118,
                "y": 31.306084,
                "value": 91
            }
        ]
        //苏州矩形坐标
        let bounds = {
            west: 120.65290308330879,
            south: 31.273633917763892,
            east: 120.79146729222676,
            north: 31.410010681404547
        };
        let heatMap = CesiumHeatmap.create(
            viewer, // 视图层
            bounds, // 矩形坐标
            { // heatmap相应参数
                backgroundColor: "rgba(0,0,0,0)",
                radius: 30,
                // 最大透明度
                maxOpacity: .5,
                minOpacity: 0,
                 // 每个点都是两个圆组成的，分别为内圆和外圆；外圆越大，看起来这个点越模糊，内圆部分比较清晰；外圆的颜色比较固定且与内圆颜色不同，内圆的颜色由value确定；blur决定外圆与内圆的占比大小，值为0-1；值越大，外圆占比越大。
                blur: .75,
                // 混合色
                gradient: {
                    0.25: "rgb(0,0,255)", 0.55: "rgb(0,255,0)", 0.85: "red", 1.0: "rgb(255,0,0)"
                }
            }
        );

        heatMap.setWGS84Data(0, 100, szPoint);

        viewer.camera.flyTo({ destination: Cesium.Rectangle.fromDegrees(120.65290308330879, 31.273633917763892, 120.79146729222676, 31.410010681404547) });
    </script>
</body>

</html>